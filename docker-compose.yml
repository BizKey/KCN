services:
  kcn_composter:
    image: kizyanov/kcn_composter:latest
    container_name: kcn_composter
    tty: true
    restart: always
    depends_on:
     - balancer
     - processor
     - nats
    links:
     - nats:nats
    env_file:
      - .env

  orderest:
    image: kizyanov/kcn_orderest:latest
    container_name: kcn_orderest
    tty: true
    restart: always
    env_file:
      - .env
    depends_on:
      - processor
      - nats

  balancer:
    image: kizyanov/kcn_balancer:latest
    container_name: kcn_balancer
    tty: true
    restart: always
    env_file:
      - .env
    depends_on:
      - processor
      - nats
    links:
     - nats:nats

  processor:
    image: kizyanov/kcn_processor:latest
    build: .
    container_name: kcn_processor
    tty: true
    restart: always
    env_file:
      - .env
    depends_on:
      - nats
    links:
     - nats:nats

  alertest:
    image: kizyanov/kcn_alertest:latest
    container_name: kcn_alertest
    tty: true
    restart: always
    env_file:
      - .env
      
  nats:
    image: nats:2.10.22-alpine3.20
    container_name: nats
    restart: always
    hostname: nats
    command: --js

